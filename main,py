import csv
import webbrowser
import os

def csv_to_html(csv_file):
    html_content = """
<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <title>Tabela CSV</title>
</head>
<body class="bg-light">
    <div class="container mt-4">
        <h2 class="mb-4">Tabela Gerada a partir do CSV</h2>
        <table class="table table-striped table-bordered">
            <thead>
    """

    with open(csv_file, newline='', encoding='utf-8') as file:
        reader = csv.reader(file)
        header = next(reader)

        html_content += "<tr>"
        for h in header:
            html_content += f"<th>{h}</th>"
        html_content += "</tr></thead><tbody>"

        for row in reader:
            html_content += "<tr>"
            for cell in row:
                html_content += f"<td>{cell}</td>"
            html_content += "</tr>"

    html_content += """
            </tbody>
        </table>
    </div>
</body>
</html>
"""

    output_file = "resultado.html"
    with open(output_file, "w", encoding="utf-8") as file:
        file.write(html_content)

    webbrowser.open("file://" + os.path.realpath(output_file))


if __name__ == "__main__":
    nome = input("Digite o nome do arquivo CSV: ")
    csv_to_html(nome)
